{"version":3,"sources":["SqlString.js"],"names":[],"mappings":"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","file":"SqlString-compiled.js","sourcesContent":["var SqlString  = exports;\nvar charsRegex = /[\\0\\b\\t\\n\\r\\x1a\\\"\\'\\\\]/g; // eslint-disable-line no-control-regex\nvar charsMap   = {\n  '\\0': '\\\\0',\n  '\\b': '\\\\b',\n  '\\t': '\\\\t',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\x1a': '\\\\Z',\n  '\"': '\\\\\"',\n  '\\'': '\\\\\\'',\n  '\\\\': '\\\\\\\\'\n};\n\nSqlString.escapeId = function escapeId(val, forbidQualified) {\n  if (Array.isArray(val)) {\n    var sql = '';\n\n    for (var i = 0; i < val.length; i++) {\n      sql += (i === 0 ? '' : ', ') + SqlString.escapeId(val[i], forbidQualified);\n    }\n\n    return sql;\n  }\n\n  if (forbidQualified) {\n    return '`' + String(val).replace(/`/g, '``') + '`';\n  }\n\n  return '`' + String(val).replace(/`/g, '``').replace(/\\./g, '`.`') + '`';\n};\n\nSqlString.escape = function escape(val, stringifyObjects, timeZone) {\n  if (val === undefined || val === null) {\n    return 'NULL';\n  }\n\n  switch (typeof val) {\n    case 'boolean': return (val) ? 'true' : 'false';\n    case 'number': return val+'';\n    case 'object':\n      if (val instanceof Date) {\n        return SqlString.dateToString(val, timeZone || 'local');\n      } else if (Array.isArray(val)) {\n        return SqlString.arrayToList(val, timeZone);\n      } else if (Buffer.isBuffer(val)) {\n        return SqlString.bufferToString(val);\n      } else if (stringifyObjects) {\n        return escapeString(val.toString());\n      } else {\n        return SqlString.objectToValues(val, timeZone);\n      }\n    default: return escapeString(val);\n  }\n};\n\nSqlString.arrayToList = function arrayToList(array, timeZone) {\n  var sql = '';\n\n  for (var i = 0; i < array.length; i++) {\n    var val = array[i];\n\n    if (Array.isArray(val)) {\n      sql += (i === 0 ? '' : ', ') + '(' + SqlString.arrayToList(val, timeZone) + ')';\n    } else {\n      sql += (i === 0 ? '' : ', ') + SqlString.escape(val, true, timeZone);\n    }\n  }\n\n  return sql;\n};\n\nSqlString.format = function format(sql, values, stringifyObjects, timeZone) {\n  if (values == null) {\n    return sql;\n  }\n\n  if (!(values instanceof Array || Array.isArray(values))) {\n    values = [values];\n  }\n\n  var chunkIndex        = 0;\n  var placeholdersRegex = /\\?\\??/g;\n  var result            = '';\n  var valuesIndex       = 0;\n  var match;\n\n  while (valuesIndex < values.length && (match = placeholdersRegex.exec(sql))) {\n    var value = match[0] === '??'\n        ? SqlString.escapeId(values[valuesIndex])\n        : SqlString.escape(values[valuesIndex], stringifyObjects, timeZone);\n\n    result += sql.slice(chunkIndex, match.index) + value;\n    chunkIndex = placeholdersRegex.lastIndex;\n    valuesIndex++;\n  }\n\n  if (chunkIndex === 0) {\n    // Nothing was replaced\n    return sql;\n  }\n\n  if (chunkIndex < sql.length) {\n    return result + sql.slice(chunkIndex);\n  }\n\n  return result;\n};\n\nSqlString.dateToString = function dateToString(date, timeZone) {\n  var dt = new Date(date);\n\n  if (isNaN(dt.getTime())) {\n    return 'NULL';\n  }\n\n  var year;\n  var month;\n  var day;\n  var hour;\n  var minute;\n  var second;\n  var millisecond;\n\n  if (timeZone === 'local') {\n    year        = dt.getFullYear();\n    month       = dt.getMonth() + 1;\n    day         = dt.getDate();\n    hour        = dt.getHours();\n    minute      = dt.getMinutes();\n    second      = dt.getSeconds();\n    millisecond = dt.getMilliseconds();\n  } else {\n    var tz = convertTimezone(timeZone);\n\n    if (tz !== false && tz !== 0) {\n      dt.setTime(dt.getTime() + (tz * 60000));\n    }\n\n    year       = dt.getUTCFullYear();\n    month       = dt.getUTCMonth() + 1;\n    day         = dt.getUTCDate();\n    hour        = dt.getUTCHours();\n    minute      = dt.getUTCMinutes();\n    second      = dt.getUTCSeconds();\n    millisecond = dt.getUTCMilliseconds();\n  }\n\n  // YYYY-MM-DD HH:mm:ss.mmm\n  var str = zeroPad(year, 4) + '-' + zeroPad(month, 2) + '-' + zeroPad(day, 2) + ' ' +\n    zeroPad(hour, 2) + ':' + zeroPad(minute, 2) + ':' + zeroPad(second, 2) + '.' +\n    zeroPad(millisecond, 3);\n\n  return escapeString(str);\n};\n\nSqlString.bufferToString = function bufferToString(buffer) {\n  return \"X\" + escapeString(buffer.toString('hex'));\n};\n\nSqlString.objectToValues = function objectToValues(object, timeZone) {\n  var sql = '';\n\n  for (var key in object) {\n    var val = object[key];\n\n    if (typeof val === 'function') {\n      continue;\n    }\n\n    sql += (sql.length === 0 ? '' : ', ') + SqlString.escapeId(key) + ' = ' + SqlString.escape(val, true, timeZone);\n  }\n\n  return sql;\n};\n\nfunction escapeString(val) {\n  var chunkIndex = charsRegex.lastIndex = 0;\n  var escapedVal = '';\n  var match;\n\n  while ((match = charsRegex.exec(val))) {\n    escapedVal += val.slice(chunkIndex, match.index) + charsMap[match[0]];\n    chunkIndex = charsRegex.lastIndex;\n  }\n\n  if (chunkIndex === 0) {\n    // Nothing was escaped\n    return \"'\" + val + \"'\";\n  }\n\n  if (chunkIndex < val.length) {\n    return \"'\" + escapedVal + val.slice(chunkIndex) + \"'\";\n  }\n\n  return \"'\" + escapedVal + \"'\";\n}\n\nfunction zeroPad(number, length) {\n  number = number.toString();\n  while (number.length < length) {\n    number = '0' + number;\n  }\n\n  return number;\n}\n\nfunction convertTimezone(tz) {\n  if (tz === 'Z') {\n    return 0;\n  }\n\n  var m = tz.match(/([\\+\\-\\s])(\\d\\d):?(\\d\\d)?/);\n  if (m) {\n    return (m[1] == '-' ? -1 : 1) * (parseInt(m[2], 10) + ((m[3] ? parseInt(m[3], 10) : 0) / 60)) * 60;\n  }\n  return false;\n}\n"]}